<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Hall of Heroes — Heroverse</title>
  <meta name="description" content="Browse the Hall of Heroes — explore origins, powers, weaknesses, allies, enemies, and appearances across the Heroverse." />
  <meta name="author" content="Your Name" />
  <link rel="icon" href="favicon.ico" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            display: ['Bangers','cursive'],
            sans: ['Poppins','ui-sans-serif','system-ui'],
          },
          colors: {
            hero:'#E50914',
            primary:'#0055FF',
            gold:'#FFD700',
            dark:'#0d0f13',
            dark2:'#111521'
          }
        }
      }
    }
  </script>

  <style>
    html{scroll-behavior:smooth}
    .comic-shadow{box-shadow:0 10px 25px rgba(0,0,0,.25),0 2px 8px rgba(0,0,0,.1)}
    .grid-auto{grid-template-columns:repeat(auto-fill,minmax(230px,1fr))}
    body::before{
      content:"";position:fixed;inset:0;z-index:-1;background:
      radial-gradient(circle at 20% 20%, rgba(255,215,0,.06), transparent 40%),
      radial-gradient(circle at 80% 0%, rgba(229,9,20,.05), transparent 35%),
      radial-gradient(circle at 0% 100%, rgba(0,85,255,.06), transparent 40%),
      repeating-radial-gradient(circle at 50% 50%, rgba(255,255,255,.04), rgba(255,255,255,.04) 2px, transparent 3px, transparent 6px);
      background-color:#0d0f13;
    }
    .reveal{opacity:0;transform:translateY(18px);transition:opacity .6s ease,transform .6s ease}
    .reveal.show{opacity:1;transform:translateY(0)}
    .glow-hover:hover{text-shadow:0 0 10px rgba(255,215,0,.7),0 0 20px rgba(255,215,0,.5)}
    .modal{position:fixed;inset:0;display:none}
    .modal.open{display:block}

    /* Select chevrons, NO white fill */
    .selectish{
      appearance:none;
      background-image:
        linear-gradient(135deg,transparent 50%,#ffd700 50%),
        linear-gradient(45deg,#ffd700 50%,transparent 50%);
      background-position:right 12px top 55%, right 6px top 55%;
      background-size:6px 6px,6px 6px;
      background-repeat:no-repeat;
      padding-right:2.25rem
    }

    .card-img{height:13.5rem}
    .profile-img{height:19rem}

    /* Modal gallery thumbnails */
    .gallery-row{
      overflow-x:auto;
      overflow-y:visible;
      padding:0.75rem 0.5rem 1rem;
      scroll-snap-type:x mandatory;
      scroll-padding-left:0.75rem;
      gap:1rem;
    }
    .gallery-row::-webkit-scrollbar{height:12px}
    .gallery-row::-webkit-scrollbar-thumb{background:#ffffff22;border-radius:999px}
    .gallery-item{
      min-width:360px;height:200px;scroll-snap-align:center;flex:0 0 auto;
    }
    @media (max-width:640px){ .gallery-item{min-width:280px;height:160px} }

    /* ========= Redesigned LIGHTBOX ========= */
    #lightbox{overscroll-behavior:contain}
    .lb-wrap{
      position:absolute;inset:0;display:flex;flex-direction:column;
      padding:16px; /* airy padding */
    }
    @media (min-width:640px){ .lb-wrap{padding:24px} }

    .lb-top{
      display:flex;align-items:center;justify-content:space-between;
      gap:.75rem;margin-bottom:.5rem;color:#fff;
    }
    .lb-title{font-weight:600}
    .lb-count{opacity:.8;font-size:.9rem}

    .lb-stage{
      position:relative;flex:1 1 auto;min-height:0; /* allows child to size nicely */
      border:1px solid rgba(255,255,255,.12);
      background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));
      border-radius:1rem; padding:10px;
      overflow:hidden; /* for panning */
      touch-action:none; /* allow manual handling for pinch/pan */
    }
    @media (min-width:640px){ .lb-stage{padding:16px;border-radius:1.25rem} }

    .lb-canvas{
      width:100%;height:100%;
      display:flex;align-items:center;justify-content:center;
      user-select:none;
    }
    .lb-img{
      max-width:96vw;max-height:80vh; /* desktop headroom */
      width:auto;height:auto;border-radius:.75rem;
      object-fit:contain;border:1px solid rgba(255,255,255,.12);
      box-shadow:0 10px 35px rgba(0,0,0,.5), 0 2px 10px rgba(0,0,0,.25);
      transform-origin:center center;
      will-change:transform;
      cursor:grab;
    }
    .lb-img.grabbing{cursor:grabbing}
    @media (min-width:640px){
      .lb-img{max-width:86vw;max-height:82vh}
    }

    .lb-arrow{
      position:absolute;top:50%;transform:translateY(-50%);
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.2);
      padding:.6rem 0.9rem;border-radius:.9rem;
      backdrop-filter:blur(4px);
    }
    .lb-arrow:hover{background:rgba(255,255,255,.14)}
    .lb-prev{left:8px}
    .lb-next{right:8px}
    @media (min-width:640px){ .lb-prev{left:14px} .lb-next{right:14px} }

    .lb-btn{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.2);padding:.45rem .7rem;border-radius:.7rem}
    .lb-btn:hover{background:rgba(255,255,255,.14)}

    .lb-bottom{
      margin-top:.6rem;
      background:rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.12);
      border-radius:.9rem;
      padding:.5rem .5rem;
    }

    .lb-thumbs-wrap{
      position:relative;display:flex;align-items:center;gap:.4rem;
    }
    .lb-scroll{
      flex:0 0 auto;
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.2);
      padding:.35rem .55rem;border-radius:.6rem;
    }
    .lb-scroll:hover{background:rgba(255,255,255,.14)}

    .lb-thumbs{
      overflow-x:auto;scroll-behavior:smooth;gap:.5rem;
      display:flex;align-items:center;padding:.2rem;
      -ms-overflow-style:none;scrollbar-width:thin;
    }
    .lb-thumbs::-webkit-scrollbar{height:10px}
    .lb-thumbs::-webkit-scrollbar-thumb{background:#ffffff22;border-radius:999px}

    .lb-thumb{
      width:110px;height:74px;flex:0 0 auto;border-radius:.5rem;
      border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.05);overflow:hidden;
      opacity:.85;transition:opacity .2s, transform .2s;
    }
    .lb-thumb:hover{opacity:1;transform:translateY(-1px)}
    .lb-thumb.active{outline:2px solid #FFD700;opacity:1}
    @media (min-width:640px){ .lb-thumb{width:130px;height:86px} }

    .lb-badge{font-size:.85rem;opacity:.9}

    /* ===== Mobile: only gallery is scrollable (vertical) ===== */
    @media (max-width:640px){
      /* Lock profile modal scrolling; only gallery will scroll */
      .profile-modal{ overflow: hidden; }
      /* Make gallery a vertical scroller with snap */
      .gallery-vert{
        display:flex; flex-direction:column;
        max-height:60vh;
        overflow-y:auto; overflow-x:hidden;
        -webkit-overflow-scrolling:touch;
        scroll-snap-type:y mandatory;
        gap:0.75rem; padding-right:4px;
      }
      .gallery-vert .gallery-item{
        min-width:100%; height:auto; aspect-ratio:16/10; scroll-snap-align:start;
      }
    }
  </style>
</head>
<body class="bg-dark text-white">
  <a href="#main" class="sr-only focus:not-sr-only focus:fixed focus:top-2 focus:left-2 bg-gold text-dark px-3 py-2 rounded">Skip to content</a>

  <!-- NAV -->
  <header class="sticky top-0 z-40 bg-dark/70 backdrop-blur border-b border-white/10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex items-center justify-between">
      <a href="index.html" class="flex items-center gap-3">
        <span class="text-2xl sm:text-3xl font-display tracking-widest text-gold drop-shadow">Heroverse</span>
      </a>

      <button id="navToggle" class="md:hidden inline-flex items-center justify-center w-10 h-10 rounded-lg border border-white/20 hover:bg-white/10" aria-label="Open menu" aria-expanded="false">
        <span class="sr-only">Menu</span> ☰
      </button>

      <nav class="hidden md:flex items-center gap-5 sm:gap-6 text-sm" aria-label="Primary">
        <a class="hover:text-gold" href="heroes.html" aria-current="page">Hall of Heroes</a>
        <a class="hover:text-gold" href="villains.html">Rogues Gallery</a>
        <a class="hover:text-gold" href="teams.html">Teams</a>
        <a class="hover:text-gold" href="stories.html">Stories</a>
        <a class="hover:text-gold" href="rankings.html">Rankings</a>
        <a class="hover:text-gold" href="news.html">News</a>
        <a class="hover:text-gold" href="about.html">About</a>
        <a class="hover:text-gold" href="contact.html">Contact</a>
      </nav>

      <button id="randomBtn" class="hidden sm:inline-flex items-center gap-2 bg-hero text-white px-3 sm:px-4 py-2 rounded-xl hover:brightness-110 transition">
        🎲 Random Hero
      </button>
    </div>

   <!-- Mobile nav drawer — COLORED -->
    <nav id="mobileNav" class="md:hidden hidden border-t border-gold/20 bg-gradient-to-b from-[#0b0f19] via-[#0c1324] to-[#0b0f19]">
      <div class="max-w-7xl mx-auto px-4 py-3 grid grid-cols-2 gap-3 text-sm">
        <a class="rounded-lg p-3 border border-primary/30 bg-primary/15 hover:bg-primary/25 transition" href="heroes.html">Hall of Heroes</a>
        <a class="rounded-lg p-3 border border-hero/30 bg-hero/15 hover:bg-hero/25 transition" href="villains.html">Rogues Gallery</a>
        <a class="rounded-lg p-3 border border-gold/30 bg-gold/15 text-dark hover:bg-gold/25 transition" href="teams.html">Teams</a>
        <a class="rounded-lg p-3 border border-white/20 bg-white/10 hover:bg-white/20 transition" href="stories.html">Stories</a>
        <a class="rounded-lg p-3 border border-white/20 bg-white/10 hover:bg-white/20 transition" href="rankings.html">Rankings</a>
        <a class="rounded-lg p-3 border border-white/20 bg-white/10 hover:bg-white/20 transition" href="news.html">News</a>
        <a class="rounded-lg p-3 border border-white/20 bg-white/10 hover:bg-white/20 transition" href="about.html">About</a>
        <a class="rounded-lg p-3 border border-white/20 bg-white/10 hover:bg-white/20 transition" href="contact.html">Contact</a>
      </div>
    </nav>
  </header>

  <main id="main" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 sm:py-12">
    <header class="text-center mb-6 reveal">
      <h1 class="font-display text-4xl sm:text-5xl">Hall of Heroes</h1>
      <p class="text-white/70 max-w-2xl mx-auto mt-2">Filter by universe, alignment, and power type. Click a card to open a full profile with origin, powers, weaknesses, allies, enemies, appearances, and gallery.</p>
    </header>

    <!-- FILTERS -->
    <section class="reveal">
      <div class="rounded-2xl border border-gold/25 bg-gradient-to-r from-[#0f1320] via-[#12172a] to-[#0f1320] p-4 sm:p-5 comic-shadow">
        <div class="grid gap-3 sm:gap-4 md:grid-cols-12 items-end">
          <div class="md:col-span-5">
            <label class="text-xs uppercase tracking-wide text-white/80">Search</label>
            <input id="search" type="text" placeholder="name, alias, power, ally, enemy…" class="mt-1 w-full rounded-2xl bg-[#141824]/90 border border-gold/30 text-white placeholder-white/60 px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-gold selectish">
          </div>

          <div class="md:col-span-2">
            <label class="text-xs uppercase tracking-wide text-white/80">Universe</label>
            <select id="universe" class="mt-1 w-full rounded-2xl bg-[#141824]/90 border border-gold/30 text-white px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-gold selectish">
              <option value="all">All</option>
              <option>Marvel</option>
              <option>DC</option>
              <option>Original</option>
            </select>
          </div>

          <div class="md:col-span-2">
            <label class="text-xs uppercase tracking-wide text-white/80">Alignment</label>
            <select id="alignment" class="mt-1 w-full rounded-2xl bg-[#141824]/90 border border-gold/30 text-white px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-gold selectish">
              <option value="all">All</option>
              <option>Hero</option>
              <option>Villain</option>
              <option>Anti-hero</option>
            </select>
          </div>

          <div class="md:col-span-3">
            <label class="text-xs uppercase tracking-wide text-white/80">Power Type</label>
            <select id="powerType" class="mt-1 w-full rounded-2xl bg-[#141824]/90 border border-gold/30 text-white px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-gold selectish">
              <option value="all">All</option>
              <option>strength</option>
              <option>speed</option>
              <option>magic</option>
              <option>tech</option>
              <option>flight</option>
              <option>energy</option>
              <option>martial arts</option>
              <option>agility</option>
              <option>spider-sense</option>
            </select>
          </div>

          <div class="md:col-span-12 flex flex-wrap gap-2 pt-2">
            <button id="clearFilters" class="px-4 py-2 rounded-xl bg-white/10 border border-white/20 hover:bg-white/20">Clear</button>
            <button id="randomBtn2" class="px-4 py-2 rounded-xl bg-hero hover:brightness-110">🎲 Random Hero</button>
          </div>
        </div>
        <p id="summary" class="mt-3 text-sm text-white/85">Loading…</p>
      </div>
    </section>

    <!-- GRID -->
    <section class="mt-6">
      <div id="grid" class="grid grid-auto gap-6 sm:gap-7"></div>
      <p id="noResults" class="hidden text-center text-white/60 mt-6">No heroes match your filters.</p>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="border-t border-white/10 py-8 text-center text-white/60">
    <p>© <span id="year"></span> Heroverse. All rights reserved.</p>
    <p>Last modified: <span id="lastModified"></span></p>
    <p class="mt-2 flex justify-center items-center gap-2">
      <span class="text-xl">⚡</span>
      <span class="text-gold font-semibold glow-hover">Henry Osuagwu</span>
      <span class="text-xl">🦸</span>
    </p>
  </footer>

  <!-- PROFILE MODAL -->
  <div id="modal" class="modal z-50">
    <div class="absolute inset-0 bg-black/70" data-close></div>
    <div class="relative max-w-5xl mx-auto mt-8 sm:mt-10 bg-dark border border-white/10 rounded-3xl comic-shadow p-6 max-h-[85vh] overflow-auto profile-modal">
      <button class="absolute top-2 right-3 text-white/70 hover:text-white" data-close>✕</button>
      <div id="modalBody"></div>
    </div>
  </div>

  <!-- ========= LIGHTBOX (spacious + bottom scroll strip) ========= -->
  <div id="lightbox" class="fixed inset-0 z-[60] hidden">
    <div class="absolute inset-0 bg-black/90" data-lb-close></div>
    <div class="lb-wrap">
      <!-- top bar -->
      <div class="lb-top">
        <div class="flex items-center gap-2">
          <span class="lb-title" id="lbCaption">Hero Name</span>
          <span class="lb-count" id="lbCount">1 / 3</span>
        </div>
        <div class="flex items-center gap-2">
          <span id="lbZoomBadge" class="lb-badge hidden sm:inline-block px-2 py-1 rounded bg-white/10 border border-white/20">100%</span>
          <button id="lbReset" class="lb-btn" title="Reset zoom">↺</button>
          <button id="lbDownload" class="lb-btn" title="Download image">⬇</button>
          <button id="lbClose" class="lb-btn lb-close" title="Close">✕</button>
        </div>
      </div>

      <!-- stage -->
      <div class="lb-stage" id="lbStage">
        <button class="lb-arrow lb-prev" id="lbPrev" aria-label="Previous">‹</button>
        <button class="lb-arrow lb-next" id="lbNext" aria-label="Next">›</button>

        <div class="lb-canvas">
          <img id="lbImg" src="" alt="Gallery image" class="lb-img" />
        </div>
      </div>

      <!-- bottom thumbs with scroll buttons -->
      <div class="lb-bottom">
        <div class="lb-thumbs-wrap">
          <button class="lb-scroll" id="thumbPrev" aria-label="Scroll thumbnails left">‹</button>
          <div class="lb-thumbs" id="lbThumbs"></div>
          <button class="lb-scroll" id="thumbNext" aria-label="Scroll thumbnails right">›</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    /* ---------- Utility & UI ---------- */
    document.getElementById('year').textContent = new Date().getFullYear();
    document.getElementById('lastModified').textContent = document.lastModified;

    const navToggle = document.getElementById('navToggle');
    const mobileNav = document.getElementById('mobileNav');
    if (navToggle && mobileNav) {
      navToggle.addEventListener('click', () => {
        const hidden = mobileNav.classList.toggle('hidden');
        navToggle.setAttribute('aria-expanded', (!hidden).toString());
      });
    }

    const io = new IntersectionObserver((entries) => entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('show'); }), { threshold: 0.12 });
    document.querySelectorAll('.reveal').forEach(el => io.observe(el));

    /* ---------- Data helpers (same) ---------- */
    const makeId = s => s.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'');
    const img = (seed) => `https://picsum.photos/seed/${encodeURIComponent(seed)}/520/600`;
    const autoGal = (id) => [
      `https://picsum.photos/seed/${encodeURIComponent(id+'-1')}/900/600`,
      `https://picsum.photos/seed/${encodeURIComponent(id+'-2')}/900/600`,
      `https://picsum.photos/seed/${encodeURIComponent(id+'-3')}/900/600`,
    ];
    const M='Marvel', D='DC', O='Original', H='Hero', AH='Anti-hero';

    /* ===== Roster (trimmed) ===== */
    const RAW = {
      Marvel: [
        'Spider-Man (Peter Parker)','Iron Man (Tony Stark)','Captain America (Steve Rogers)','Thor',
        'Hulk (Bruce Banner)','Black Panther (T’Challa)','Doctor Strange (Stephen Strange)','Scarlet Witch (Wanda Maximoff)',
        'Vision','Ant-Man (Scott Lang)','Wasp (Hope van Dyne / Janet van Dyne)','Hawkeye (Clint Barton)',
        'Black Widow (Natasha Romanoff)','Falcon (Sam Wilson)','Winter Soldier (Bucky Barnes)','Star-Lord (Peter Quill)',
        'Gamora','Drax the Destroyer','Rocket Raccoon','Groot','Mantis','Captain Marvel (Carol Danvers)','Wolverine (Logan)',
        'Storm (Ororo Munroe)','Cyclops (Scott Summers)','Jean Grey','Professor X (Charles Xavier)','Beast (Hank McCoy)',
        'Rogue','Nightcrawler (Kurt Wagner)','Deadpool (Wade Wilson)','Daredevil (Matt Murdock)','Luke Cage',
        'Iron Fist (Danny Rand)','Jessica Jones','Punisher (Frank Castle)','Blade','Ghost Rider (Johnny Blaze)',
        'Moon Knight (Marc Spector)','Silver Surfer'
      ],
      DC: [
        'Superman (Clark Kent / Kal-El)','Batman (Bruce Wayne)','Wonder Woman (Diana Prince)','The Flash (Barry Allen)',
        'Green Lantern (Hal Jordan)','Aquaman (Arthur Curry)','Cyborg (Victor Stone)','Green Arrow (Oliver Queen)',
        'Supergirl (Kara Zor-El)','Batgirl (Barbara Gordon)','Nightwing (Dick Grayson)','Robin (Damian Wayne)',
        'Shazam (Billy Batson)','Zatanna','Martian Manhunter (J’onn J’onzz)','Hawkman','Hawkgirl','Black Canary (Dinah Lance)',
        'Constantine (John Constantine)','Blue Beetle (Jaime Reyes)','Booster Gold','Plastic Man','Firestorm',
        'Atom (Ray Palmer)','Red Tornado','Doctor Fate','Huntress (Helena Bertinelli)','Power Girl','Vixen','Mister Miracle',
        'Rorschach','Doctor Manhattan','Silk Spectre','Ozymandias'
      ],
      Original: [
        'Spawn','Hellboy','The Tick','Kick-Ass (Dave Lizewski)','Hit-Girl (Mindy Macready)','Invincible (Mark Grayson)',
        'Omni-Man','Atom Eve','Static Shock (Virgil Hawkins)','Big Daddy','Green Hornet','Kato','Space Ghost',
        'Darkwing Duck','Samurai Jack','Ben 10 (Ben Tennyson)','Aang','Korra','He-Man (Prince Adam)','She-Ra (Adora)',
        'Lion-O','Astro Boy','Sailor Moon (Usagi Tsukino)','Goku','Vegeta','One Punch Man (Saitama)'
      ]
    };

    const POWER_HINTS = { 
      'Spider-Man':'agility,spider-sense,strength','Iron Man':'tech,flight,energy','Captain America':'strength,agility',
      'Thor':'strength,energy,flight,magic','Hulk':'strength','Black Panther':'agility,martial arts,tech',
      'Doctor Strange':'magic,energy','Scarlet Witch':'magic,energy','Vision':'energy,flight,tech',
      'Ant-Man':'tech,agility','Wasp':'tech,flight,agility','Hawkeye':'martial arts,agility,tech',
      'Black Widow':'martial arts,agility,tech','Falcon':'flight,tech,agility','Winter Soldier':'martial arts,tech,strength',
      'Star-Lord':'tech,agility','Gamora':'martial arts,agility,strength','Drax the Destroyer':'strength',
      'Rocket Raccoon':'tech,agility','Groot':'strength,energy','Mantis':'magic,agility',
      'Captain Marvel':'energy,flight,strength','Wolverine':'martial arts,agility,strength',
      'Storm':'energy,flight,magic','Cyclops':'energy','Jean Grey':'magic,energy','Professor X':'magic',
      'Beast':'strength,agility','Rogue':'energy,strength','Nightcrawler':'agility,magic','Deadpool':'martial arts,agility',
      'Daredevil':'martial arts,agility','Luke Cage':'strength','Iron Fist':'martial arts,magic',
      'Jessica Jones':'strength','Punisher':'martial arts,tech','Blade':'martial arts','Ghost Rider':'magic,energy',
      'Moon Knight':'martial arts,magic','Silver Surfer':'energy,flight',
      'Superman':'strength,flight,energy','Batman':'tech,martial arts,agility','Wonder Woman':'strength,agility,magic',
      'The Flash':'speed,energy','Green Lantern':'energy,flight','Aquaman':'strength,magic','Cyborg':'tech,strength',
      'Green Arrow':'martial arts,agility,tech','Supergirl':'strength,flight,energy','Batgirl':'martial arts,tech,agility',
      'Nightwing':'martial arts,agility','Robin':'martial arts,agility','Shazam':'magic,strength,energy','Zatanna':'magic',
      'Martian Manhunter':'magic,strength,energy,flight','Hawkman':'strength,flight','Hawkgirl':'strength,flight',
      'Black Canary':'martial arts,energy','Constantine':'magic','Blue Beetle':'tech,flight,energy','Booster Gold':'tech,flight',
      'Plastic Man':'magic,agility','Firestorm':'energy','Atom':'tech','Red Tornado':'energy','Doctor Fate':'magic,energy',
      'Huntress':'martial arts,agility','Power Girl':'strength,flight,energy','Vixen':'magic,agility',
      'Mister Miracle':'tech,agility','Rorschach':'martial arts','Doctor Manhattan':'energy,magic',
      'Silk Spectre':'martial arts,agility','Ozymandias':'tech,martial arts',
      'Spawn':'magic,energy','Hellboy':'strength,magic','The Tick':'strength','Kick-Ass':'martial arts',
      'Hit-Girl':'martial arts,agility','Invincible':'strength,flight','Omni-Man':'strength,flight',
      'Atom Eve':'energy,magic','Static Shock':'energy','Big Daddy':'martial arts,tech','Green Hornet':'tech,martial arts',
      'Kato':'martial arts,agility','Space Ghost':'energy,flight','Darkwing Duck':'agility,tech',
      'Samurai Jack':'martial arts','Ben 10':'tech,energy','Aang':'magic,agility','Korra':'magic,strength',
      'He-Man':'strength,magic','She-Ra':'strength,magic','Lion-O':'strength,agility','Astro Boy':'tech,flight,energy',
      'Sailor Moon':'magic,energy','Goku':'strength,energy,flight','Vegeta':'strength,energy,flight','One Punch Man':'strength,speed'
    };

    function parseNameAlias(s){
      const m = s.match(/^(.*?)\s*\((.+?)\)\s*$/);
      return m ? { name: m[1].trim(), alias: m[2].trim() } : { name: s.trim(), alias: '' };
    }

    const BASE =
      []
      .concat(RAW.Marvel.map(s => ({ ...parseNameAlias(s), universe: M })))
      .concat(RAW.DC.map(s => ({ ...parseNameAlias(s), universe: D })))
      .concat(RAW.Original.map(s => ({ ...parseNameAlias(s), universe: O })))
      .map(h => {
        const hint = (POWER_HINTS[h.name] || '').split(',').map(x=>x.trim()).filter(Boolean);
        return { id: makeId(h.name), name: h.name, alias: h.alias, universe: h.universe, alignment: H, powerType: hint, image: img(h.name) };
      });

    const DETAILS = {
      'iron-man': {
        powers: ['Powered armor','AI-assisted targeting','Repulsors','Flight'],
        weaknesses: ['Arc reactor dependency (classic)'],
        allies: ['Avengers','Pepper Potts','War Machine'],
        enemies: ['Mandarin','Ultron'],
        appearances: ['Tales of Suspense','MCU: Iron Man'],
        origin: 'Genius billionaire who built the Iron Man suit to escape captivity.',
        image: 'https://picsum.photos/seed/im/520/600',
        gallery: [
          'https://picsum.photos/seed/im-g1/900/600',
          'https://picsum.photos/seed/im-g2/900/600',
          'https://picsum.photos/seed/im-g3/900/600'
        ]
      },
      'wonder-woman': {
        powers: ['Super strength','Bracelets of Submission','Lasso of Truth','Combat skill'],
        weaknesses: ['Bound by her own lasso (classic lore)'],
        allies: ['Justice League','Steve Trevor'],
        enemies: ['Ares','Cheetah'],
        appearances: ['Wonder Woman (comics)','WW (2017 film)'],
        origin: 'Amazonian princess from Themyscira, demi-god heritage.',
        gallery: [
          'https://picsum.photos/seed/wwg/900/600',
          'https://picsum.photos/seed/wwg2/900/600'
        ]
      }
    };

    const DEFAULTS = {
      powersFromType: {
        strength: ['Super strength','Durability'],
        speed: ['Super speed','Reflexes'],
        magic: ['Mystic arts','Spellcasting'],
        tech: ['Advanced technology','Gadgets'],
        flight: ['Flight'],
        energy: ['Energy projection'],
        'martial arts': ['Expert combatant'],
        agility: ['Enhanced agility'],
        'spider-sense': ['Precognition-like spider-sense']
      },
      weaknessesFromType: {
        magic: ['Anti-magic wards'],
        tech: ['EMP vulnerability'],
        speed: ['Energy depletion'],
        strength: ['Overconfidence'],
        flight: ['Aerial disorientation (rare)'],
        energy: ['Power overload'],
        'martial arts': ['Human vulnerabilities'],
        agility: ['Fatigue'],
        'spider-sense': ['Sensory overload']
      },
      alliesByUniverse: { Marvel: ['Avengers'], DC: ['Justice League'], Original: ['Allies vary'] },
      enemiesByUniverse: { Marvel: ['Iconic rogues vary'], DC: ['Iconic rogues vary'], Original: ['Nemeses vary'] },
      appearancesByUniverse: {
        Marvel: ['Comics (Marvel)','Animated/Films (various)'],
        DC: ['Comics (DC)','Animated/Films (various)'],
        Original: ['Comics/Animation (various)']
      },
      originByUniverse: {
        Marvel: 'Hero from the Marvel Universe; story varies by continuity.',
        DC: 'Hero from the DC Universe; story varies by continuity.',
        Original: 'Hero from indie/animated universes; story varies by series.'
      }
    };

    const HEROES = BASE.map(h => {
      const d = DETAILS[h.id] || {};
      const typePowers = (h.powerType||[]).flatMap(t => DEFAULTS.powersFromType[t] || []);
      const typeWeak = (h.powerType||[]).flatMap(t => DEFAULTS.weaknessesFromType[t] || []);
      return {
        ...h,
        image: d.image || h.image,
        powers: d.powers || [...new Set(typePowers)].slice(0,4),
        weaknesses: d.weaknesses || [...new Set(typeWeak)].slice(0,3),
        allies: d.allies || DEFAULTS.alliesByUniverse[h.universe] || ['Allies vary'],
        enemies: d.enemies || DEFAULTS.enemiesByUniverse[h.universe] || ['Nemeses vary'],
        appearances: d.appearances || DEFAULTS.appearancesByUniverse[h.universe] || ['Appearances vary'],
        origin: d.origin || DEFAULTS.originByUniverse[h.universe],
        gallery: (d.gallery && d.gallery.length ? d.gallery : autoGal(h.id))
      };
    });

    /* ---------- Render ---------- */
    const elGrid = document.getElementById('grid');
    const elSummary = document.getElementById('summary');
    const elNoResults = document.getElementById('noResults');
    const elSearch = document.getElementById('search');
    const elUniverse = document.getElementById('universe');
    const elAlignment = document.getElementById('alignment');
    const elPowerType = document.getElementById('powerType');

    function heroCard(hero){
      const tags = [hero.universe, hero.alignment].filter(Boolean).map(t =>
        `<span class="px-2 py-0.5 rounded-lg bg:white/10 border border-white/10 text-xs">${t}</span>`
      ).join(' ');
      return `
        <article class="bg-white/5 border border-white/10 rounded-2xl overflow-hidden hover:-translate-y-0.5 hover:bg-white/10 transition comic-shadow">
          <div class="card-img bg-white/5 overflow-hidden flex items-center justify-center">
            <img loading="lazy" src="${hero.image}" alt="${hero.name}" class="w-full h-full object-contain">
          </div>
          <div class="p-4 text-center">
            <h3 class="font-display text-2xl text-gold">${hero.name}</h3>
            <p class="text-white/70">${hero.alias || ''}</p>
            <p class="text-white/80 text-sm mt-2">Powers: ${(hero.powerType||[]).join(', ') || '—'}</p>
            <div class="mt-2 flex gap-2 justify-center">${tags}</div>
            <button class="inline-block mt-3 bg-primary px-4 py-2 rounded-xl hover:brightness-110" data-open="${hero.id}">View Profile</button>
          </div>
        </article>
      `;
    }

    function applyFilters(){
      const q = (elSearch.value || '').trim().toLowerCase();
      const u = elUniverse.value;
      const a = elAlignment.value;
      const p = elPowerType.value;

      let list = HEROES.filter(h=>{
        const text = [
          h.name, h.alias,
          (h.powerType||[]).join(' '),
          (h.powers||[]).join(' '),
          (h.allies||[]).join(' '),
          (h.enemies||[]).join(' ')
        ].join(' ').toLowerCase();
        const matchQ = !q || text.includes(q);
        const matchU = (u==='all') || (h.universe===u);
        const matchA = (a==='all') || (h.alignment===a);
        const matchP = (p==='all') || (h.powerType||[]).includes(p);
        return matchQ && matchU && matchA && matchP;
      });

      elSummary.textContent = `${list.length} result${list.length===1?'':'s'} • ${u==='all'?'All universes':u} • ${a==='all'?'All alignments':a} • ${p==='all'?'All powers':p}`;
      elGrid.innerHTML = list.map(heroCard).join('');
      elNoResults.classList.toggle('hidden', list.length>0);

      document.querySelectorAll('[data-open]').forEach(btn=>{
        btn.addEventListener('click', ()=> openProfile( HEROES.find(h=>h.id===btn.dataset.open) ));
      });
    }

    /* ---------- Modal ---------- */
    const modal = document.getElementById('modal');
    const modalBody = document.getElementById('modalBody');
    modal.addEventListener('click', (e)=>{ if (e.target.dataset.close!==undefined) closeModal(); });
    document.querySelectorAll('[data-close]').forEach(x=> x.addEventListener('click', closeModal));
    function openModal(){ modal.classList.add('open'); document.body.style.overflow='hidden'; }
    function closeModal(){ modal.classList.remove('open'); document.body.style.overflow=''; }

    const listRow = (title, arr) => arr && arr.length
      ? `<div><h4 class="font-semibold">${title}</h4><p class="text-white/80">${arr.join(', ')}</p></div>` : '';

    function profileHTML(h){
      const chips = [h.universe, h.alignment, ...(h.powerType||[])]
        .filter(Boolean)
        .map(x=>`<span class="px-2 py-1 rounded-lg bg-white/10 border border-white/10 text-xs">${x}</span>`).join(' ');

      const gallery = (h.gallery||[]).map((src,i)=>`
        <img loading="lazy" src="${src}" alt="${h.name} gallery image ${i+1}"
             class="gallery-item rounded-xl object-cover bg-white/5 border border-white/10 cursor-zoom-in"
             data-hero="${h.id}" data-idx="${i}">
      `).join('');

      return `
        <div class="space-y-6">
          <header class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
            <div>
              <h2 class="font-display text-3xl text-gold">${h.name}</h2>
              <p class="text-white/70">${h.alias || ''}</p>
            </div>
            <div class="flex flex-wrap gap-2">${chips}</div>
          </header>

          <div class="grid md:grid-cols-3 gap-6">
            <div class="md:col-span-1">
              <div class="bg-white/5 rounded-2xl overflow-hidden border border-white/10">
                <img src="${h.image}" alt="${h.name}" class="w-full profile-img object-contain bg-white/5">
              </div>
            </div>

            <div class="md:col-span-2 space-y-5">
              <div>
                <h3 class="font-semibold">Origin</h3>
                <p class="text-white/80">${h.origin || '—'}</p>
              </div>

              ${listRow('Powers & Abilities', h.powers)}
              ${listRow('Weaknesses', h.weaknesses)}
              ${listRow('Allies', h.allies)}
              ${listRow('Enemies', h.enemies)}
              ${listRow('Appearances', h.appearances)}

              <section>
                <div class="flex items-center justify-between mb-2"><h3 class="font-semibold">Image Gallery</h3><button class="px-2 py-1 text-sm rounded bg-white/10 border border-white/20 hover:bg-white/20" data-open-full>Open full-screen</button></div>
                <div class="gallery-row flex gallery-vert">${gallery}</div>
                <p class="text-xs text-white/60 mt-2">Tip: Tap a thumbnail to open the full-screen viewer. Use ← → keys or swipe.</p>
              </section>
            </div>
          </div>
        </div>
      `;
    }

    /* ---------- Lightbox (spacious + scroll buttons + zoom/pan/download) ---------- */
    const lightbox = document.getElementById('lightbox');
    const lbImg = document.getElementById('lbImg');
    const lbPrev = document.getElementById('lbPrev');
    const lbNext = document.getElementById('lbNext');
    const lbClose = document.getElementById('lbClose');
    const lbThumbs = document.getElementById('lbThumbs');
    const lbCaption = document.getElementById('lbCaption');
    const lbCount = document.getElementById('lbCount');
    const thumbPrev = document.getElementById('thumbPrev');
    const thumbNext = document.getElementById('thumbNext');
    const lbStage = document.getElementById('lbStage');
    const lbDownload = document.getElementById('lbDownload');
    const lbReset = document.getElementById('lbReset');
    const lbZoomBadge = document.getElementById('lbZoomBadge');

    let lbState = { heroId: null, index: 0 };

    function openLightbox(heroId, index){
      const hero = HEROES.find(h => h.id === heroId);
      if (!hero) return;

      lbState.heroId = heroId;
      lbState.index = index;

      lbImg.src = hero.gallery[index];
      lbImg.alt = `${hero.name} full image ${index+1}`;
      lbCaption.textContent = hero.name;
      lbCount.textContent = `${index+1} / ${hero.gallery.length}`;

      lbThumbs.innerHTML = hero.gallery.map((src, i) => `
        <button class="lb-thumb ${i===index?'active':''}" data-lb-idx="${i}" title="Image ${i+1}">
          <img src="${src}" alt="${hero.name} thumbnail ${i+1}" class="w-full h-full object-cover">
        </button>
      `).join('');

      lbThumbs.querySelectorAll('[data-lb-idx]').forEach(btn=>{
        btn.addEventListener('click', () => setLightboxIndex(+btn.getAttribute('data-lb-idx')));
      });

      lightbox.classList.remove('hidden');
      document.body.style.overflow = 'hidden';

      ensureThumbVisible(index);
      resetZoom();
    }

    function closeLightbox(){
      lightbox.classList.add('hidden');
      document.body.style.overflow = '';
    }

    function setLightboxIndex(idx){
      const hero = HEROES.find(h => h.id === lbState.heroId);
      if (!hero) return;
      const len = hero.gallery.length;
      lbState.index = (idx + len) % len;
      lbImg.src = hero.gallery[lbState.index];
      lbImg.alt = `${hero.name} full image ${lbState.index+1}`;
      lbCount.textContent = `${lbState.index+1} / ${len}`;
      highlightActiveThumb(lbState.index);
      ensureThumbVisible(lbState.index);
      resetZoom();
    }

    function navLightbox(dir){
      const hero = HEROES.find(h => h.id === lbState.heroId);
      if (!hero) return;
      setLightboxIndex(lbState.index + dir);
    }

    function highlightActiveThumb(idx){
      lbThumbs.querySelectorAll('.lb-thumb').forEach((el,i)=>{
        el.classList.toggle('active', i===idx);
      });
    }

    function ensureThumbVisible(idx){
      const active = lbThumbs.querySelectorAll('.lb-thumb')[idx];
      if (active) active.scrollIntoView({ behavior:'smooth', inline:'center', block:'nearest' });
    }

    // Lightbox controls
    lbPrev.addEventListener('click', () => navLightbox(-1));
    lbNext.addEventListener('click', () => navLightbox(1));
    lbClose.addEventListener('click', closeLightbox);
    lightbox.addEventListener('click', (e) => { if (e.target.hasAttribute('data-lb-close')) closeLightbox(); });

    // Scroll buttons for thumbnail rail
    function scrollThumbs(dir){
      const delta = Math.round(lbThumbs.clientWidth * 0.9) * dir;
      lbThumbs.scrollBy({ left: delta, behavior: 'smooth' });
    }
    thumbPrev.addEventListener('click', () => scrollThumbs(-1));
    thumbNext.addEventListener('click', () => scrollThumbs(1));

    // Keyboard + swipe
    window.addEventListener('keydown', (e)=>{
      if (lightbox.classList.contains('hidden')) return;
      if (e.key === 'Escape') closeLightbox();
      if (e.key === 'ArrowRight') navLightbox(1);
      if (e.key === 'ArrowLeft') navLightbox(-1);
    });
    let dragX = null;
    lbImg.addEventListener('pointerdown', (e)=>{ dragX = e.clientX; lbImg.setPointerCapture(e.pointerId); });
    lbImg.addEventListener('pointerup', (e)=>{
      if (dragX == null) return;
      const dx = e.clientX - dragX;
      dragX = null;
      if (Math.abs(dx) > 40 && scale === 1) {
        if (dx > 0) navLightbox(-1); else navLightbox(1);
      }
    });

    /* ====== Zoom & Pan ====== */
    let scale = 1, minScale = 1, maxScale = 4;
    let tx = 0, ty = 0; // translate offsets
    let isPanning = false, startX = 0, startY = 0;
    let lastTap = 0;

    function applyTransform(){
      lbImg.style.transform = `translate(${tx}px, ${ty}px) scale(${scale})`;
      lbZoomBadge.textContent = `${Math.round(scale*100)}%`;
      lbZoomBadge.classList.toggle('hidden', scale === 1);
    }

    function resetZoom(){
      scale = 1; tx = 0; ty = 0; applyTransform();
    }

    function clampPan(){
      const rect = lbImg.getBoundingClientRect();
      const stageRect = lbStage.getBoundingClientRect();
      const imgW = rect.width / scale, imgH = rect.height / scale;
      const viewW = stageRect.width, viewH = stageRect.height;
      const maxX = Math.max(0, (imgW*scale - viewW) / 2) + 20;
      const maxY = Math.max(0, (imgH*scale - viewH) / 2) + 20;
      tx = Math.min(maxX, Math.max(-maxX, tx));
      ty = Math.min(maxY, Math.max(-maxY, ty));
    }

    // Double-click / Double-tap to toggle zoom
    lbImg.addEventListener('dblclick', (e)=>{
      e.preventDefault();
      if (scale === 1) zoomAt(e.clientX, e.clientY, 2);
      else resetZoom();
    });
    lbImg.addEventListener('pointerdown', (e)=>{
      const now = Date.now();
      if (now - lastTap < 300) { // double-tap
        e.preventDefault();
        if (scale === 1) zoomAt(e.clientX, e.clientY, 2);
        else resetZoom();
      }
      lastTap = now;
    });

    // Wheel zoom (desktop)
    lbStage.addEventListener('wheel', (e)=>{
      e.preventDefault();
      const delta = -Math.sign(e.deltaY) * 0.2; // zoom step
      const targetScale = Math.min(maxScale, Math.max(minScale, scale + delta));
      zoomAt(e.clientX, e.clientY, targetScale);
    }, { passive:false });

    function zoomAt(clientX, clientY, targetScale){
      const stageRect = lbStage.getBoundingClientRect();
      const cx = clientX - stageRect.left - stageRect.width/2;
      const cy = clientY - stageRect.top - stageRect.height/2;
      const scaleRatio = targetScale / scale;
      tx = cx - (cx - tx) * scaleRatio;
      ty = cy - (cy - ty) * scaleRatio;
      scale = targetScale;
      clampPan();
      applyTransform();
    }

    // Drag / Pan when zoomed
    lbImg.addEventListener('pointerdown', (e)=>{
      if (scale === 1) return; // allow swipe nav when not zoomed
      isPanning = true; startX = e.clientX - tx; startY = e.clientY - ty;
      lbImg.setPointerCapture(e.pointerId);
      lbImg.classList.add('grabbing');
    });
    lbImg.addEventListener('pointermove', (e)=>{
      if (!isPanning) return;
      tx = e.clientX - startX; ty = e.clientY - startY;
      clampPan();
      applyTransform();
    });
    lbImg.addEventListener('pointerup', ()=>{ isPanning = false; lbImg.classList.remove('grabbing'); });
    lbImg.addEventListener('pointercancel', ()=>{ isPanning = false; lbImg.classList.remove('grabbing'); });

    // Reset button
    lbReset.addEventListener('click', resetZoom);

    // Download current slide
    lbDownload.addEventListener('click', async ()=>{
      const hero = HEROES.find(h => h.id === lbState.heroId); if (!hero) return;
      const url = hero.gallery[lbState.index];
      try {
        const imgEl = new Image();
        imgEl.crossOrigin = 'anonymous';
        imgEl.src = url + (url.includes('?') ? '&' : '?') + 'download=1';
        await imgEl.decode();
        const canvas = document.createElement('canvas');
        canvas.width = imgEl.naturalWidth; canvas.height = imgEl.naturalHeight;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(imgEl, 0, 0);
        canvas.toBlob((blob)=>{
          if (!blob) { window.open(url, '_blank'); return; }
          const a = document.createElement('a');
          a.href = URL.createObjectURL(blob);
          const fnameBase = (hero.name || 'image').toLowerCase().replace(/[^a-z0-9]+/g,'-');
          a.download = `${fnameBase}-${lbState.index+1}.jpg`;
          document.body.appendChild(a);
          a.click();
          a.remove();
          setTimeout(()=> URL.revokeObjectURL(a.href), 2000);
        }, 'image/jpeg', 0.92);
      } catch(err){
        window.open(url, '_blank');
      }
    });

    /* ---------- Open profile & wire thumbnails from modal ---------- */
    function openProfile(hero){
      modalBody.innerHTML = profileHTML(hero);
      openModal();
      setTimeout(() => {
        document.querySelectorAll('#modalBody img[data-hero]').forEach(img=>{
          img.addEventListener('click', () => {
            openLightbox(img.getAttribute('data-hero'), +img.getAttribute('data-idx') || 0);
          });
        });
        const btnFull = document.querySelector('#modalBody [data-open-full]');
        if (btnFull) {
          btnFull.addEventListener('click', ()=> openLightbox(hero.id, 0));
        }
      }, 0);
    }

    /* ---------- Wire up ---------- */
    applyFilters();
    [elSearch, elUniverse, elAlignment, elPowerType].forEach(el=>{
      el.addEventListener('input', applyFilters);
      el.addEventListener('change', applyFilters);
    });
    document.getElementById('clearFilters').addEventListener('click', ()=>{
      elSearch.value=''; elUniverse.value='all'; elAlignment.value='all'; elPowerType.value='all'; applyFilters();
    });
    function openRandom(){
      const h = HEROES[Math.floor(Math.random()*HEROES.length)];
      openProfile(h);
    }
    const rb = document.getElementById('randomBtn'); if (rb) rb.addEventListener('click', openRandom);
    const rb2 = document.getElementById('randomBtn2'); if (rb2) rb2.addEventListener('click', openRandom);
  </script>

  <style>
#mobileNav a:hover{
background: rgba(255,215,0,0.15);
color: #FFD700;
}


/* Skip to top button */
#toTop {
position: fixed;
bottom: 1rem;
right: 1rem;
background: #FFD700;
color: #0d0f13;
padding: 0.5rem 0.75rem;
border-radius: 0.5rem;
font-weight: bold;
cursor: pointer;
box-shadow: 0 4px 10px rgba(0,0,0,.25);
display: none;
z-index: 50;
}
#toTop:hover{ background:#e5c100; }
</style>
</head>
<body id="top"$1>
<!-- Skip to content -->
<a href="#main" class="sr-only focus:not-sr-only focus:fixed focus:top-2 focus:left-2 bg-gold text-dark px-3 py-2 rounded">Skip to content</a>

<!-- existing body content remains -->
<main id="main"></main>


<!-- Floating “Skip to Top” button -->
<a id="toTop" href="#top"
class="hidden fixed bottom-4 right-4 z-50 rounded-full bg-gold text-dark px-3 py-2 shadow-lg border border-white/20
focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gold"
aria-label="Skip to top">↑ Top</a>


<!-- Skip to Top button -->
<button id="toTop" aria-label="Back to top">↑ Top</button>


<script>
const toTop = document.getElementById('toTop');
const toggleToTop = () => {
  if (window.scrollY > 400) {
    toTop.classList.remove('hidden');
    toTop.style.display = 'block';
  } else {
    toTop.classList.add('hidden');
    toTop.style.display = 'none';
  }
};
toggleToTop();
window.addEventListener('scroll', toggleToTop, { passive: true });
toTop.addEventListener('click', ()=>{
  window.scrollTo({ top:0, behavior:'smooth' });
});
</script>
</body>
</html>
